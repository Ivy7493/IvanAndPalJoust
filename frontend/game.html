<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="arrow.svg">
    <title>This Way Up</title>
</head>
<body>

    <div class="nav">
        <img id="logo" src="logoWhite.svg" alt="logo">
    </div>

    <p id="debug">
        Debug text
    </p>

    <div class="bigIcon">
        <img src="thisWayUpWhite.svg" />
    </div>

    <div class="shakeBar">
    </div>

</body>
</html>

<script type="module">
    import Color from "https://colorjs.io/dist/color.js";

    const shakeBar = document.querySelector(".shakeBar");
    const root = document.querySelector(":root");
    const debug = document.querySelector("#debug");

    const barCol1 = new Color("lightgreen");
    const barCol2 = new Color("tomato");
    const barGradient = barCol1.range(barCol2, {space: "lch", outputSpace: "srgb", hue: "increasing"});

    let percentage = 0.0;

    // window.addEventListener("deviceorientation", (event) => {
    //     debug.innerHTML = tilt([event.beta, event.gamma]);
    // }, true);

    if (window.DeviceOrientationEvent) {
    addEventListener("deviceorientation", function (event) {
        // debug.textContent = event.beta;
        }, true);
    }
    if (window.DeviceMotionEvent) {
    addEventListener('devicemotion', function () {
        // debug.textContent = event.acceleration.x.toFixed(2);
        setPercentage(event.acceleration.x + event.acceleration.y);
        }, true);
    }
    else {
    addEventListener("MozOrientation", function (event) {
        // debug.textContent = orientation.x;
        }, true);
    }

    function setPercentage(perc) {
        percentage = perc;
        updateShakeBar();
    }

    function addPercentage() {
        percentage += 0.5;
        percentage %= 100;
        updateShakeBar();
        // document.writeln("asdf");
    }

    function updateShakeBar() {
        shakeBar.style.height = percentage + "%";

        shakeBar.style.opacity = remap(percentage, 0.0, 100.0, 20.0, 30.0) + "%";
        // shakeBar.style.backgroundColor = barGradient(percentage/100.0).toString();
        root.style.setProperty("--shakeAmount", percentage/10.0 + "px");
        document.body.style.backgroundColor = barGradient(percentage/100.0).toString();
    }

    function remap(x, fromMin, fromMax, toMin, toMax) {
        return ((x - fromMin)/fromMax)*toMax + toMin;
    }

    // setPercentage(50.0);
    setInterval(addPercentage, 30);

</script>